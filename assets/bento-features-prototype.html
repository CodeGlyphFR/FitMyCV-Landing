<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Features Marquee — Prototype v3</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #0a0a1a;
  --card-bg: rgba(255,255,255,0.04);
  --card-border: rgba(255,255,255,0.08);
  --cyan: #22d3ee;
  --green: #34d399;
  --blue: #60a5fa;
  --purple: #a78bfa;
  --orange: #fb923c;
  --text: #e2e8f0;
  --text-muted: #94a3b8;
  --text-dim: #64748b;
  --row-gap: 1rem;
  --card-gap: 1rem;
}

body {
  font-family: 'Inter', system-ui, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}


/* ===== STATS STRIP ===== */
.stats-strip {
  display: flex; justify-content: center; align-items: center; gap: 3rem;
  padding: 2.5rem 2rem;
  border-top: 1px solid rgba(255,255,255,0.06);
  border-bottom: 1px solid rgba(255,255,255,0.06);
  background: linear-gradient(180deg, rgba(34,211,238,0.03) 0%, transparent 100%);
}
.stat-item { text-align: center; }
.stat-value {
  font-size: 2.2rem; font-weight: 800;
  background: linear-gradient(135deg, var(--cyan), var(--green));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text; line-height: 1.2;
}
.stat-label { font-size: 0.8rem; color: var(--text-muted); margin-top: 0.2rem; }
.stat-separator { width: 1px; height: 2rem; background: rgba(255,255,255,0.1); }

/* ===== SECTION ===== */
.features-section {
  padding: 4rem 0 5rem;
  overflow: hidden;
}

.section-header {
  text-align: center;
  margin-bottom: 3rem;
  padding: 0 1.5rem;
}

.section-title {
  font-size: clamp(1.8rem, 4.5vw, 2.8rem);
  font-weight: 800;
  background: linear-gradient(135deg, var(--cyan), var(--green), var(--blue));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text; line-height: 1.2; margin-bottom: 0.6rem;
}

.section-subtitle {
  font-size: 1.05rem; color: var(--text-dim); font-style: italic;
}

/* ===== MARQUEE GRID ===== */
.marquee-grid {
  display: flex;
  flex-direction: column;
  gap: var(--row-gap);
  padding: 0.75rem 0;
  /* Fade edges */
  -webkit-mask-image: linear-gradient(90deg, transparent 0%, black 6%, black 94%, transparent 100%);
  mask-image: linear-gradient(90deg, transparent 0%, black 6%, black 94%, transparent 100%);
}

.marquee-row {
  display: flex;
  gap: var(--card-gap);
  width: max-content;
  will-change: transform;
}

.marquee-row.scroll-left {
  animation: scrollLeft 40s linear infinite;
}
.marquee-row.scroll-right {
  animation: scrollRight 45s linear infinite;
}
.marquee-row.scroll-left-slow {
  animation: scrollLeft 50s linear infinite;
}

@keyframes scrollLeft {
  0% { transform: translateX(0); }
  100% { transform: translateX(calc(-50% - var(--card-gap) / 2)); }
}
@keyframes scrollRight {
  0% { transform: translateX(calc(-50% - var(--card-gap) / 2)); }
  100% { transform: translateX(0); }
}

/* ===== CARDS ===== */
.f-card {
  flex-shrink: 0;
  border-radius: 1rem;
  background: var(--card-bg);
  border: 1px solid var(--card-border);
  padding: 1.25rem;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
  user-select: none;
}

@media (hover: hover) {
  .f-card.hovered {
    transform: translateY(-6px) scale(1.03);
    border-color: rgba(34,211,238,0.35);
    box-shadow: 0 16px 50px rgba(0,0,0,0.4), 0 0 30px rgba(34,211,238,0.06);
    z-index: 5;
  }
}

.f-card:active {
  transform: translateY(-2px) scale(1.02);
  border-color: rgba(34,211,238,0.3);
  box-shadow: 0 8px 30px rgba(0,0,0,0.3), 0 0 20px rgba(34,211,238,0.08);
  z-index: 5;
}

/* Glow border */
.f-card::before {
  content: '';
  position: absolute; inset: -1px;
  border-radius: 1rem; padding: 1px;
  background: conic-gradient(from var(--a,0deg) at var(--mx,50%) var(--my,50%), var(--cyan), var(--green), var(--blue), var(--cyan));
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor; mask-composite: exclude;
  opacity: 0; transition: opacity 0.35s;
  z-index: 1; pointer-events: none;
}
@media (hover: hover) {
  .f-card.hovered::before { opacity: 1; }
}

/* ===== SIZE VARIANTS ===== */
.f-card { height: 200px; }
.card-lg { width: 340px; }
.card-md { width: 300px; }
.card-sm { width: 240px; }
.card-wide { width: 360px; }

/* ===== CARD CONTENT ===== */
.f-card .c-title {
  font-size: 1.1rem; font-weight: 700; color: #fff;
  line-height: 1.25; margin-bottom: 0.35rem;
  position: relative; z-index: 2;
}
.card-sm .c-title { font-size: 1rem; }
.card-lg .c-title, .card-wide .c-title { font-size: 1.15rem; }

.f-card .c-sub {
  font-size: 0.8rem; color: var(--text-dim); font-style: italic;
  line-height: 1.4; position: relative; z-index: 2;
}
.card-sm .c-sub { font-size: 0.75rem; }

.f-card .c-vis {
  flex: 1; margin-top: 0.75rem;
  border-radius: 0.5rem; overflow: hidden;
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(255,255,255,0.05);
  position: relative; z-index: 2;
}



/* ===== MINI VISUALS ===== */

/* Score mini */
.vis-score { display:flex; align-items:center; justify-content:center; height:100%; gap:0.75rem; padding:0.5rem; }
.mini-circle { position:relative; width:65px; height:65px; }
.mini-circle svg { width:65px; height:65px; transform:rotate(-90deg); }
.sc-bg { fill:none; stroke:rgba(255,255,255,0.06); stroke-width:6; }
.sc-fg { fill:none; stroke:url(#sg); stroke-width:6; stroke-linecap:round; stroke-dasharray:170; stroke-dashoffset:170; transition:stroke-dashoffset 2s ease; }
.mini-circle.anim .sc-fg { stroke-dashoffset: 27; }
.sc-num { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:1.1rem; font-weight:800; color:var(--green); }
.mini-bars { display:flex; flex-direction:column; gap:0.3rem; flex:1; }
.mb-label { font-size:0.55rem; color:var(--text-muted); }
.mb-track { height:4px; border-radius:2px; background:rgba(255,255,255,0.06); overflow:hidden; }
.mb-fill { height:100%; border-radius:2px; width:0; transition:width 1.5s ease; }
.mini-circle.anim ~ .mini-bars .mb1 .mb-fill { width:92%; background:var(--green); }
.mini-circle.anim ~ .mini-bars .mb2 .mb-fill { width:78%; background:var(--cyan); }
.mini-circle.anim ~ .mini-bars .mb3 .mb-fill { width:85%; background:var(--blue); }

/* Mockup mini */
.vis-mockup { display:flex; flex-direction:column; height:100%; padding:0.5rem; gap:0.3rem; }
.mk-bar { display:flex; gap:0.25rem; padding:0.15rem 0; }
.mk-d { width:6px; height:6px; border-radius:50%; }
.mk-d:nth-child(1){background:#ef4444} .mk-d:nth-child(2){background:#eab308} .mk-d:nth-child(3){background:#22c55e}
.mk-body { flex:1; display:flex; gap:0.3rem; }
.mk-side { width:25%; display:flex; flex-direction:column; gap:0.25rem; }
.mk-si { height:1rem; border-radius:0.15rem; background:rgba(255,255,255,0.06); }
.mk-si.on { background:rgba(34,211,238,0.15); border:1px solid rgba(34,211,238,0.3); }
.mk-main { flex:1; border-radius:0.3rem; background:rgba(255,255,255,0.03); padding:0.3rem; display:flex; flex-direction:column; gap:0.25rem; }
.mk-l { height:0.4rem; border-radius:0.1rem; background:rgba(255,255,255,0.08); }
.mk-l.sh { width:55%; }
.mk-l.hi { background:rgba(52,211,153,0.2); border:1px solid rgba(52,211,153,0.3); }

/* Langs mini */
.vis-lang { display:flex; align-items:center; justify-content:center; height:100%; gap:0.4rem; padding:0.4rem; flex-wrap:nowrap; }
.lg-i { text-align:center; padding:0.35rem 0.45rem; border-radius:0.35rem; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); transition:all 0.4s; }
.lg-i.on { border-color:rgba(34,211,238,0.4); box-shadow:0 0 12px rgba(34,211,238,0.08); }
.lg-f { font-size:1.2rem; }
.lg-n { font-size:0.5rem; color:var(--text-muted); margin-top:0.1rem; }
.lg-arr { color:var(--cyan); font-size:0.8rem; animation:lp 2s ease infinite; }
@keyframes lp { 0%,100%{opacity:0.3;transform:translateX(0)} 50%{opacity:1;transform:translateX(2px)} }

/* Edit mini */
.vis-edit { display:flex; flex-direction:column; height:100%; padding:0.5rem; gap:0.2rem; }
.ed-r { display:flex; align-items:center; gap:0.3rem; padding:0.15rem 0.3rem; border-radius:0.2rem; }
.ed-r.act { background:rgba(34,211,238,0.06); border:1px solid rgba(34,211,238,0.12); }
.ed-cur { width:1.5px; height:0.7rem; background:var(--cyan); animation:bk 1s step-end infinite; }
@keyframes bk { 0%,100%{opacity:1} 50%{opacity:0} }
.ed-t { height:0.35rem; border-radius:0.1rem; background:rgba(255,255,255,0.07); }
.ed-t.a{width:100px} .ed-t.b{width:70px} .ed-t.c{width:85px} .ed-t.d{width:60px}
.ed-t.ch { background:rgba(52,211,153,0.2); border:1px solid rgba(52,211,153,0.25); }

/* History mini */
.vis-hist { display:flex; align-items:center; justify-content:center; height:100%; gap:0.25rem; padding:0.4rem; }
.hd { width:8px; height:8px; border-radius:50%; border:2px solid rgba(255,255,255,0.12); }
.hd.p { border-color:rgba(34,211,238,0.3); background:rgba(34,211,238,0.12); }
.hd.a { border-color:var(--cyan); background:var(--cyan); box-shadow:0 0 8px rgba(34,211,238,0.25); }
.hl { width:14px; height:1.5px; background:rgba(255,255,255,0.06); }
.hl.d { background:rgba(34,211,238,0.25); }

/* Recap mini */
.vis-recap { display:flex; flex-direction:column; height:100%; padding:0.5rem; gap:0.25rem; justify-content:center; }
.rc-r { display:flex; gap:0.4rem; align-items:center; }
.rc-l { font-size:0.5rem; color:var(--text-dim); width:38px; text-align:right; flex-shrink:0; }
.rc-v { height:0.35rem; border-radius:0.1rem; background:rgba(52,211,153,0.12); border:1px solid rgba(52,211,153,0.18); flex:1; }
.rc-v.s { width:50%; flex:none; }

/* Anti-bot mini */
.vis-bot { display:flex; flex-direction:column; height:100%; padding:0.5rem; gap:0.2rem; }
.bot-blocked { display:flex; flex-direction:column; gap:0.2rem; padding:0.3rem; border-radius:0.25rem; background:rgba(239,68,68,0.04); border:1px solid rgba(239,68,68,0.1); flex:1; }
.bot-ok { display:flex; flex-direction:column; gap:0.2rem; padding:0.3rem; border-radius:0.25rem; background:rgba(52,211,153,0.04); border:1px solid rgba(52,211,153,0.1); flex:1; }
.bot-lbl { font-size:0.5rem; color:var(--text-dim); margin-bottom:0.1rem; }
.bot-line { height:0.35rem; border-radius:0.1rem; }
.bot-line.fail { background:rgba(239,68,68,0.15); }
.bot-line.ok { background:rgba(52,211,153,0.2); }
.bot-line.w50 { width:50%; } .bot-line.w70 { width:70%; } .bot-line.w80 { width:80%; }

/* Export mini */
.vis-export { display:flex; align-items:center; justify-content:center; height:100%; gap:0.6rem; padding:0.5rem; }
.exp-fmt { text-align:center; padding:0.5rem; border-radius:0.4rem; background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06); }
.exp-icon { font-size:1.3rem; margin-bottom:0.15rem; }
.exp-label { font-size:0.55rem; color:var(--text-muted); }

/* Template mini */
.vis-tpl {
  display:flex; align-items:center; justify-content:center; height:100%; padding:0.5rem;
}
.tpl-search {
  display:flex; align-items:center; gap:0.5rem;
  width:100%; padding:0.4rem 0.8rem;
}
.tpl-search-icon { width:1.1rem; height:1.1rem; opacity:0.4; flex-shrink:0; }
.tpl-search-text {
  flex:1; font-size:0.85rem; color:rgba(255,255,255,0.8); font-family:'Inter',sans-serif;
  white-space:nowrap; overflow:hidden; min-height:1rem;
  border-bottom:1.5px solid rgba(255,255,255,0.15); padding-bottom:0.2rem;
}

/* Batch mini */
.vis-batch { display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; padding:0.5rem; gap:0.5rem; }
.batch-docs { display:flex; gap:0.3rem; }
.batch-doc {
  width:36px; height:44px; border-radius:0.2rem;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.08);
  padding:0.2rem; display:flex; flex-direction:column; gap:0.12rem;
  position:relative; opacity:0; transform:translateY(8px);
  transition: opacity 0.4s, transform 0.4s, border-color 0.3s, box-shadow 0.3s;
}
.batch-doc.visible { opacity:1; transform:translateY(0); }
.batch-doc.done { border-color:rgba(52,211,153,0.4); box-shadow:0 0 8px rgba(52,211,153,0.08); }
.bd-l { height:2px; border-radius:1px; background:rgba(255,255,255,0.08); }
.bd-l.sh { width:60%; }
.bd-check {
  position:absolute; bottom:0.15rem; right:0.15rem;
  font-size:0.5rem; color:var(--green); opacity:0; transition:opacity 0.3s;
}
.batch-doc.done .bd-check { opacity:1; }
.batch-counter { font-size:0.65rem; color:var(--text-dim); }
.batch-counter .bc-num { color:var(--green); font-weight:700; font-size:0.8rem; }

/* Import mini */
.c-vis:has(.vis-import),
.c-vis:has(.vis-score),
.c-vis:has(.vis-reco),
.c-vis:has(.vis-review),
.c-vis:has(.vis-history),
.c-vis:has(.vis-inline),
.c-vis:has(.vis-export-order),
.c-vis:has(.vis-lang-btn),
.c-vis:has(.vis-translate),
.c-vis:has(.vis-tasks) { background:none; border:none; }
.vis-import {
  display:flex; align-items:center; justify-content:center;
  height:100%; padding:0.4rem; position:relative;
}
.imp-zone {
  width:100%; border-radius:0.4rem;
  border:1.5px dashed rgba(255,255,255,0.2);
  background:rgba(255,255,255,0.03);
  padding:0.5rem 0.4rem; display:flex; flex-direction:column; align-items:center;
  justify-content:center; gap:0.2rem;
  transition: border-color 0.3s, background 0.3s, box-shadow 0.3s;
}
.imp-zone.drag-over {
  border-color:var(--green);
  background:rgba(16,185,129,0.12);
  box-shadow:0 0 12px rgba(16,185,129,0.15);
}
.imp-zone.loaded {
  border-color:rgba(52,211,153,0.5);
  background:rgba(16,185,129,0.1);
}
.imp-zone.loaded .imp-upload-icon,
.imp-zone.loaded .imp-label { visibility:hidden; }
.imp-zone.loaded .imp-done { display:flex; }
.imp-upload-icon { width:1.2rem; height:1.2rem; opacity:0.4; }
.imp-label { font-size:0.6rem; color:var(--text-dim); font-weight:500; }
.imp-zone { position:relative; }
.imp-done {
  display:none; align-items:center; gap:0.3rem;
  font-size:0.55rem; color:white; font-weight:500;
  position:absolute; inset:0; justify-content:center;
}
.imp-file-ghost {
  position:absolute; display:flex; align-items:center; gap:0.25rem;
  background:rgba(30,41,59,0.95); border:1px solid rgba(255,255,255,0.25);
  border-radius:0.25rem; padding:0.15rem 0.4rem;
  font-size:0.5rem; color:white; white-space:nowrap;
  box-shadow:0 4px 14px rgba(0,0,0,0.4);
  opacity:0; pointer-events:none;
  transition: opacity 0.25s;
  top:0.2rem; right:0.3rem;
}
.imp-file-ghost.visible { opacity:1; }

/* ATS rewrite mini */
.vis-ats {
  display:flex; flex-direction:column; justify-content:center;
  height:100%; padding:0.5rem; gap:0.3rem;
}
.ats-line {
  font-size:0.5rem; font-family:'Inter',sans-serif; line-height:1.4;
  padding:0.15rem 0.3rem; border-radius:0.2rem;
  transition: all 0.4s ease;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.ats-line.old {
  color:rgba(255,255,255,0.3); text-decoration:line-through;
}
.ats-line.rewriting {
  color:rgba(52,211,153,0.9); text-decoration:none;
  background:rgba(52,211,153,0.06);
}

/* Score badge mini */
.vis-score {
  display:flex; align-items:center; justify-content:center; height:100%; gap:0.4rem;
}
.sc-badge {
  width:3.4rem; height:3.4rem; border-radius:50%;
  border:3px solid rgba(255,255,255,0.3);
  display:flex; align-items:center; justify-content:center;
  position:relative;
  transition: border-color 0.5s, opacity 0.4s, transform 0.4s;
}
.sc-old {
  border-color:var(--orange-500, #f97316);
  opacity:0; transform:scale(0.7);
}
.sc-old.visible { opacity:1; transform:scale(1); }
.sc-old .sc-num { color:var(--orange-500, #f97316); }
.sc-new {
  opacity:0; transform:scale(0.7);
}
.sc-new.visible { opacity:1; transform:scale(1); }
.sc-arrow {
  font-size:1.1rem; color:rgba(255,255,255,0.4);
  opacity:0; transition: opacity 0.3s;
}
.sc-arrow.visible { opacity:1; }
.sc-refresh {
  width:1rem; height:1rem; color:rgba(255,255,255,0.7);
  position:absolute;
}
.sc-refresh.spinning { animation: sc-spin 1.2s linear infinite; }
.sc-refresh.hidden { display:none; }
@keyframes sc-spin { to { transform:rotate(360deg); } }
.sc-num {
  font-size:1.1rem; font-weight:800; line-height:1;
}

/* Reco suggestions mini */
.vis-reco {
  display:flex; flex-direction:column; height:100%; padding:0.4rem; gap:0.3rem;
  justify-content:flex-start; position:relative;
}
.vis-reco {
  mask-image:linear-gradient(to bottom, white 0%, white 70%, transparent 100%);
  -webkit-mask-image:linear-gradient(to bottom, white 0%, white 70%, transparent 100%);
}
.reco-item {
  border-radius:0.3rem; padding:0.3rem 0.4rem;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);
  opacity:0; transform:translateY(6px);
  transition: opacity 0.4s, transform 0.4s;
}
.reco-item.visible { opacity:1; transform:translateY(0); }
.reco-header {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:0.15rem;
}
.reco-badge {
  font-size:0.4rem; font-weight:700; padding:0.1rem 0.3rem;
  border-radius:0.15rem; text-transform:uppercase; letter-spacing:0.02em;
}
.reco-badge.high { background:rgba(239,68,68,0.15); color:#f87171; }
.reco-badge.med { background:rgba(234,179,8,0.15); color:#facc15; }
.reco-badge.low { background:rgba(96,165,250,0.15); color:#60a5fa; }
.reco-pts {
  font-size:0.4rem; font-weight:700; color:var(--green);
}
.reco-text {
  font-size:0.5rem; color:rgba(255,255,255,0.7); line-height:1.3;
}

/* Fiche offre tags mini */
.vis-fiche {
  display:flex; align-items:center; justify-content:center; height:100%; padding:0.4rem;
}
.fiche-tags {
  display:flex; flex-wrap:wrap; gap:0.25rem; justify-content:center; align-content:center;
}
.fiche-tag {
  font-size:0.5rem; font-weight:600; padding:0.15rem 0.4rem;
  border-radius:0.8rem; white-space:nowrap;
  opacity:0; transform:scale(0.8);
  transition: opacity 0.3s, transform 0.3s;
}
.fiche-tag.visible { opacity:1; transform:scale(1); }
.fiche-tag.skill { background:rgba(34,211,238,0.12); color:#22d3ee; border:1px solid rgba(34,211,238,0.25); }
.fiche-tag.method { background:rgba(168,85,247,0.12); color:#c084fc; border:1px solid rgba(168,85,247,0.25); }
.fiche-tag.benefit { background:rgba(52,211,153,0.12); color:#34d399; border:1px solid rgba(52,211,153,0.25); }

/* Review mode mini */
.vis-review {
  display:flex; flex-direction:column; height:100%; padding:0.4rem; gap:0.3rem;
  justify-content:center;
}
.rev-change {
  display:flex; align-items:center; gap:0.3rem;
  border-radius:0.3rem; padding:0.25rem 0.35rem;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);
  opacity:0; transform:translateY(6px);
  transition: opacity 0.4s, transform 0.4s;
}
.rev-change.visible { opacity:1; transform:translateY(0); }
.rev-diff { flex:1; display:flex; flex-direction:column; gap:0.1rem; min-width:0; }
.rev-old {
  font-size:0.42rem; color:rgba(248,113,113,0.7); text-decoration:line-through;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.rev-new {
  font-size:0.42rem; color:rgba(52,211,153,0.9); font-weight:600;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.rev-actions { display:flex; gap:0.15rem; flex-shrink:0; }
.rev-btn {
  width:1rem; height:1rem; border-radius:0.2rem;
  display:flex; align-items:center; justify-content:center;
  font-size:0.45rem; cursor:pointer;
  transition: background 0.3s, transform 0.2s;
}
.rev-accept {
  color:#34d399; background:rgba(52,211,153,0.08); border:1px solid rgba(52,211,153,0.2);
}
.rev-accept.flash { background:rgba(52,211,153,0.3); transform:scale(1.15); }
.rev-reject {
  color:#f87171; background:rgba(248,113,113,0.08); border:1px solid rgba(248,113,113,0.2);
}
.rev-reject.flash { background:rgba(248,113,113,0.3); transform:scale(1.15); }
.rev-change.accepted { border-color:rgba(52,211,153,0.3); background:rgba(52,211,153,0.05); }
.rev-change.rejected { border-color:rgba(248,113,113,0.2); background:rgba(248,113,113,0.03); opacity:0.5; }

/* History versions mini */
.vis-history {
  display:flex; flex-direction:column; height:100%; padding:0.4rem; gap:0.25rem;
  justify-content:center;
}
.hist-row {
  display:flex; align-items:center; justify-content:space-between;
  padding:0.25rem 0.4rem; border-radius:0.25rem;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);
  opacity:0; transform:translateX(-6px);
  transition: opacity 0.4s, transform 0.4s, border-color 0.3s, background 0.3s;
}
.hist-row.visible { opacity:1; transform:translateX(0); }
.hist-row.active { border-color:rgba(52,211,153,0.4); background:rgba(52,211,153,0.06); }
.hist-label { font-size:0.5rem; color:rgba(255,255,255,0.5); font-weight:600; }
.hist-score { font-size:0.55rem; font-weight:800; }
.hs-low { color:var(--orange-500, #f97316); }
.hs-mid { color:#facc15; }
.hs-high { color:#34d399; }

/* Inline edit mini */
.vis-inline {
  display:flex; flex-direction:column; height:100%; padding:0.4rem; gap:0.2rem;
  justify-content:center;
}
.inl-row {
  display:flex; align-items:center; gap:0.3rem;
  padding:0.25rem 0.35rem; border-radius:0.25rem;
  background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.06);
  position:relative;
}
.inl-text { flex:1; font-size:0.5rem; color:rgba(255,255,255,0.7); }
.inl-kebab {
  font-size:0.7rem; color:rgba(255,255,255,0.4); cursor:pointer;
  line-height:1; padding:0 0.15rem;
  transition: color 0.2s;
}
.inl-row.active .inl-kebab { color:var(--cyan); }
.inl-menu {
  position:absolute; right:0; top:100%; margin-top:0.1rem;
  background:rgba(15,23,42,0.95); border:1px solid rgba(255,255,255,0.12);
  border-radius:0.25rem; padding:0.15rem 0;
  box-shadow:0 4px 12px rgba(0,0,0,0.4);
  opacity:0; transform:translateY(-4px) scale(0.95);
  transition: opacity 0.2s, transform 0.2s;
  pointer-events:none; z-index:2;
}
.inl-menu.visible { opacity:1; transform:translateY(0) scale(1); pointer-events:auto; }
.inl-opt {
  font-size:0.45rem; padding:0.2rem 0.5rem; white-space:nowrap;
  transition: background 0.15s;
}
.inl-opt.edit { color:var(--cyan); }
.inl-opt.del { color:#f87171; }
.inl-opt.highlight { background:rgba(255,255,255,0.08); }

/* Export order mini */
.vis-export-order {
  display:flex; flex-direction:column; height:100%; padding:0.4rem; gap:0.2rem;
  justify-content:center;
}
.exo-card {
  display:flex; align-items:center; gap:0.3rem;
  padding:0.25rem 0.35rem; border-radius:0.25rem;
  background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08);
  transition: transform 0.4s ease, box-shadow 0.3s, border-color 0.3s;
}
.exo-card.dragging {
  border-color:rgba(34,211,238,0.4);
  box-shadow:0 4px 12px rgba(0,0,0,0.3);
  z-index:2;
}
.exo-handle { font-size:0.6rem; color:rgba(255,255,255,0.25); cursor:grab; }
.exo-card.dragging .exo-handle { color:var(--cyan); }
.exo-check {
  font-size:0.4rem; color:var(--green);
  width:0.7rem; height:0.7rem; border-radius:0.15rem;
  background:rgba(52,211,153,0.12); border:1px solid rgba(52,211,153,0.3);
  display:flex; align-items:center; justify-content:center;
}
.exo-name { font-size:0.5rem; color:rgba(255,255,255,0.7); flex:1; }
.exo-btn {
  text-align:center; padding:0.25rem; border-radius:0.25rem;
  background:var(--green); color:white; font-size:0.5rem; font-weight:700;
  margin-top:0.05rem;
}

/* Language button mini (matches SaaS LanguageSwitcher) */
.vis-lang-btn {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:100%; gap:0;
}
.lang-badge {
  width:2.5rem; height:2.5rem; border-radius:50%;
  background:rgba(255,255,255,0.2);
  backdrop-filter:blur(16px);
  border:2px solid rgba(255,255,255,0.3);
  box-shadow:0 8px 32px rgba(0,0,0,0.3);
  display:flex; align-items:center; justify-content:center;
  position:relative; overflow:hidden;
  padding:0.3rem;
  cursor:pointer;
}
.lang-flag {
  position:absolute; width:1.6rem; height:1.6rem;
  border-radius:50%; object-fit:cover;
  opacity:0; transform:scale(0.7);
  transition: opacity 0.3s, transform 0.3s;
}
.lang-flag.active { opacity:1; transform:scale(1); }
.lang-label {
  font-size:0.5rem; color:rgba(255,255,255,0.5); font-weight:500;
  margin-top:0.2rem;
}

/* Translate card — circular carousel */
.vis-translate {
  display:flex; align-items:center; justify-content:center; height:100%;
}
.tr-carousel {
  position:relative; width:9rem; height:3.5rem;
}
.tr-flag {
  position:absolute; width:2.6rem; height:2.6rem;
  top:50%; margin-top:-1.3rem;
  border-radius:50%;
  background:rgba(255,255,255,0.2);
  backdrop-filter:blur(16px);
  border:2px solid rgba(255,255,255,0.3);
  box-shadow:0 4px 16px rgba(0,0,0,0.25);
  display:flex; align-items:center; justify-content:center;
  padding:0.25rem; overflow:hidden;
}
.tr-flag img { width:100%; height:100%; border-radius:50%; object-fit:cover; }
.tr-flag.tr-move {
  transition: left 0.5s cubic-bezier(0.4,0,0.2,1),
              transform 0.5s cubic-bezier(0.4,0,0.2,1),
              opacity 0.5s ease,
              border-color 0.5s ease,
              box-shadow 0.5s ease;
}
.tr-flag[data-pos="-2"] { left:-2.6rem; transform:scale(0.6); opacity:0; }
.tr-flag[data-pos="-1"] { left:0; transform:scale(0.75); opacity:0.5; }
.tr-flag[data-pos="0"]  { left:50%; margin-left:-1.3rem; transform:scale(1.15);
  border-color:rgba(34,211,238,0.5); box-shadow:0 0 14px rgba(34,211,238,0.25); }
.tr-flag[data-pos="1"]  { left:calc(100% - 2.6rem); transform:scale(0.75); opacity:0.5; }
.tr-flag[data-pos="2"]  { left:calc(100% + 0.5rem); transform:scale(0.6); opacity:0; }

/* Task manager card */
.vis-tasks {
  display:flex; flex-direction:column; gap:0.35rem;
  height:100%; padding:0.4rem; justify-content:flex-start; padding-top:0.5rem;
  mask-image:linear-gradient(to bottom, #000 60%, transparent 100%);
  -webkit-mask-image:linear-gradient(to bottom, #000 60%, transparent 100%);
}
.tsk-item {
  padding:0.3rem 0.4rem;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
.tsk-item:last-child { border-bottom:none; }
.tsk-line1 {
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:0.2rem;
}
.tsk-title {
  font-size:0.5rem; font-weight:500; color:white;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.tsk-pct {
  font-size:0.5rem; font-weight:500; color:rgba(255,255,255,0.5);
  font-variant-numeric:tabular-nums; flex-shrink:0; margin-left:0.4rem;
}
.tsk-pct.done { color:#34d399; }
.tsk-bar {
  height:0.25rem; border-radius:9999px;
  background:rgba(255,255,255,0.1);
  overflow:hidden;
}
.tsk-fill {
  height:100%; border-radius:9999px; width:0%;
  background:linear-gradient(to right, #10b981, #34d399, #4ade80);
  transition:width 0.4s ease-out;
}
.tsk-fill.done { background:linear-gradient(to right, #10b981, #34d399); }
.tsk-step {
  font-size:0.4rem; color:rgba(255,255,255,0.4);
  margin-top:0.1rem;
}

/* ===== CARD 1: Generator mini-modal (real mockup design) ===== */
.vis-gen {
  position: relative; height: 100%; display: flex; flex-direction: column;
  overflow: hidden; background: rgb(2,6,23); border-radius: 0.4rem;
}
.gm-body { padding: 0.4rem 0.5rem; display: flex; flex-direction: column; gap: 0.2rem; flex: 1; }
.gm-label {
  font-size: 0.4rem; font-weight: 500; color: rgba(255,255,255,0.9);
  text-transform: uppercase; letter-spacing: 0.05em;
}
.gm-select {
  display: flex; align-items: center; gap: 0.2rem;
  padding: 0.2rem 0.35rem; border-radius: 0.25rem;
  border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05);
  color: white; font-size: 0.45rem;
}
.gm-doc-icon { width: 0.55rem; height: 0.55rem; color: rgba(255,255,255,0.5); flex-shrink: 0; }
.gm-select-date { font-size: 0.35rem; color: rgba(255,255,255,0.4); flex-shrink: 0; }
.gm-select-text { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.gm-flag { width: 0.6rem; height: 0.6rem; border-radius: 50%; flex-shrink: 0; }
.gm-arrow { font-size: 0.35rem; opacity: 0.5; margin-left: auto; flex-shrink: 0; }
.gm-link-row { display: flex; align-items: stretch; gap: 0.2rem; }
.gm-history-btn {
  display: flex; align-items: center; justify-content: center;
  width: 1.1rem; flex-shrink: 0; border-radius: 0.25rem;
  border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05);
  font-size: 0.45rem; cursor: default;
}
.gm-input {
  flex: 1; min-width: 0;
  padding: 0.2rem 0.35rem; border-radius: 0.25rem; min-height: 1.1rem;
  border: 1px solid rgba(255,255,255,0.2); background: rgba(255,255,255,0.05);
  color: white; font-size: 0.4rem; font-family: 'Inter', monospace;
  white-space: nowrap; overflow: hidden;
  transition: border-color 0.2s, box-shadow 0.2s;
}
.gm-input.typing {
  border-color: rgba(16,185,129,0.5);
  box-shadow: 0 0 0 2px rgba(16,185,129,0.15);
}
.gm-actions {
  display: flex; justify-content: flex-end; gap: 0.3rem; margin-top: auto; padding-top: 0.15rem;
}
.gm-cancel { font-size: 0.4rem; color: rgba(148,163,184,1); padding: 0.15rem 0.35rem; }
.gm-validate {
  font-size: 0.4rem; color: #fff; padding: 0.15rem 0.5rem; border-radius: 0.25rem;
  background: #10b981;
  font-weight: 600; transition: box-shadow 0.2s, background 0.2s;
}
.gm-validate.flash { box-shadow: 0 0 10px rgba(16,185,129,0.5); background: #059669; }
.gm-cursor {
  position: absolute; pointer-events: none; z-index: 5;
  transition: left 0.5s cubic-bezier(0.4,0,0.2,1), top 0.5s cubic-bezier(0.4,0,0.2,1);
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));
}

/* ===== RESPONSIVE — MOBILE (<768px) ===== */
@media (max-width: 767px) {
  .stats-strip {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 1rem; padding: 1.5rem 1.5rem;
  }
  .stat-separator { display: none; }
  .stat-value { font-size: 1.8rem; }

  .features-section { padding: 2rem 0 2.5rem; }
  .section-header { margin-bottom: 1.5rem; }

  /* 3 rows, condensed */
  .marquee-grid { gap: 0.5rem; padding: 0.4rem 0; }

  .f-card { height: 120px; width: 180px !important; padding: 0.65rem; border-radius: 0.7rem; }
  .f-card .c-title { font-size: 0.75rem; margin-bottom: 0.15rem; }
  .card-sm .c-title, .card-lg .c-title, .card-wide .c-title { font-size: 0.75rem; }
  .f-card .c-sub { display: none; }
  .f-card .c-vis { margin-top: 0.35rem; border-radius: 0.3rem; overflow: hidden; }

  /* Scale visual content uniformly — except vis-gen and simple visuals */
  .f-card .c-vis > * { transform: scale(0.6); transform-origin: center center; }
  .f-card .c-vis > .vis-gen {
    transform: scale(0.75); transform-origin: top left;
    width: calc(100% / 0.75); height: calc(100% / 0.75);
  }
  .f-card .c-vis > .vis-tpl,
  .f-card .c-vis > .vis-import,
  .f-card .c-vis > .vis-ats,
  .f-card .c-vis > .vis-score,
  .f-card .c-vis > .vis-reco,
  .f-card .c-vis > .vis-fiche,
  .f-card .c-vis > .vis-review,
  .f-card .c-vis > .vis-history,
  .f-card .c-vis > .vis-inline,
  .f-card .c-vis > .vis-export-order { transform: none; }
  .vis-export-order .exo-card:first-child { display:none; }
  .f-card .c-vis > .vis-lang-btn { transform: none; }
  .f-card .c-vis > .vis-translate { transform: none; }
  .f-card .c-vis > .vis-tasks { transform: none; }
  .tr-carousel { width:6.5rem; height:2.6rem; }
  .tr-flag { width:1.8rem; height:1.8rem; margin-top:-0.9rem; padding:0.15rem; }
  .tr-flag[data-pos="-2"] { left:-1.8rem; }
  .tr-flag[data-pos="0"] { margin-left:-0.9rem; }
  .tr-flag[data-pos="1"] { left:calc(100% - 1.8rem); }
  .sc-badge { width:2.4rem; height:2.4rem; border-width:2px; }
  .sc-num { font-size:0.75rem; }
  .sc-arrow { font-size:0.8rem; }
  .sc-refresh { width:0.75rem; height:0.75rem; }
  .fiche-tag { font-size:0.4rem; padding:0.1rem 0.3rem; }
  .fiche-tags { gap:0.15rem; }
  .tpl-search { padding:0.2rem 0.4rem; gap:0.3rem; }
  .tpl-search-icon { width:0.7rem; height:0.7rem; }
  .tpl-search-text { font-size:0.55rem; min-height:0.7rem; }
  .f-card .gm-actions { display: none; }
}
</style>
</head>
<body>

<svg style="position:absolute;width:0;height:0;">
  <defs>
    <linearGradient id="sg" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#22d3ee"/>
      <stop offset="100%" style="stop-color:#34d399"/>
    </linearGradient>
  </defs>
</svg>

<div class="stats-strip">
  <div class="stat-item"><div class="stat-value">87%</div><div class="stat-label">de correspondance</div></div>
  <div class="stat-separator"></div>
  <div class="stat-item"><div class="stat-value">5</div><div class="stat-label">langues</div></div>
  <div class="stat-separator"></div>
  <div class="stat-item"><div class="stat-value">30s</div><div class="stat-label">pour optimiser</div></div>
  <div class="stat-separator"></div>
  <div class="stat-item"><div class="stat-value">0&euro;</div><div class="stat-label">sans abonnement</div></div>
</div>

<section class="features-section">
  <div class="section-header">
    <h2 class="section-title">Tout ce qu'il faut pour d&eacute;crocher le poste</h2>
    <p class="section-subtitle">Con&ccedil;u pour vos CVs. Pas un &eacute;ni&egrave;me chatbot.</p>
  </div>

  <div class="marquee-grid">

    <!-- ROW 1: scroll left -->
    <div class="marquee-row scroll-left" id="row1">

      <div class="f-card card-lg" data-id="1">
        <div class="c-title">Un CV taill&eacute; pour chaque offre</div>
        <div class="c-sub">Collez un lien, l'IA fait le reste</div>
        <div class="c-vis"><div class="vis-gen" id="vis-gen">
          <div class="gm-body">
            <div class="gm-label">CV de r&eacute;f&eacute;rence</div>
            <div class="gm-select"><svg class="gm-doc-icon" viewBox="0 0 24 24"><path d="M6 2a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6H6zm7 1.5L18.5 9H14a1 1 0 01-1-1V3.5zM8 13h8v1H8v-1zm0 3h5v1H8v-1z" fill="currentColor"/></svg><span class="gm-select-date">07/02</span><span class="gm-select-text">D&eacute;veloppeur Full-Stack JS</span><img class="gm-flag" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22c%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url(%23c)%22%3E%3Crect%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23002395%22%2F%3E%3Crect%20x%3D%22170%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23fff%22%2F%3E%3Crect%20x%3D%22340%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23ED2939%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E" alt="FR"><span class="gm-arrow">&#9662;</span></div>
            <div class="gm-label">Lien offre d'emploi</div>
            <div class="gm-link-row"><div class="gm-history-btn">&#128203;</div><div class="gm-input" id="gm-link"></div></div>
            <div class="gm-actions"><span class="gm-cancel">Annuler</span><span class="gm-validate" id="gm-validate">Valider</span></div>
          </div>
          <div class="gm-cursor" id="gm-cursor"><svg width="12" height="16" viewBox="0 0 12 16"><path d="M1 1l10 7-5 1.5-2.5 5.5z" fill="#fff" stroke="#222" stroke-width="0.8"/></svg></div>
        </div></div>

      </div>

      <div class="f-card card-md" data-id="2">
        <div class="c-title">10 CV en un clic</div>
        <div class="c-sub">Toutes vos candidatures en parall&egrave;le</div>
        <div class="c-vis"><div class="vis-batch"><div class="batch-docs"><div class="batch-doc"><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-check">&#10003;</div></div><div class="batch-doc"><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-check">&#10003;</div></div><div class="batch-doc"><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-check">&#10003;</div></div><div class="batch-doc"><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-check">&#10003;</div></div><div class="batch-doc"><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-l"></div><div class="bd-l sh"></div><div class="bd-check">&#10003;</div></div></div><div class="batch-counter"><span class="bc-num">0</span>/10</div></div></div>

      </div>

      <div class="f-card card-md" data-id="3">
        <div class="c-title">Un template en quelques mots</div>
        <div class="c-sub">Pas de lien ? Un titre de poste suffit</div>
        <div class="c-vis"><div class="vis-tpl"><div class="tpl-search"><svg class="tpl-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg><span class="tpl-search-text"></span></div></div></div>

      </div>

      <div class="f-card card-md" data-id="4">
        <div class="c-title">Importez votre CV en un geste</div>
        <div class="c-sub">Glissez un PDF, l'IA structure tout</div>
        <div class="c-vis"><div class="vis-import">
          <div class="imp-zone">
            <svg class="imp-upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/></svg>
            <span class="imp-label">Choisir un fichier PDF</span>
            <div class="imp-done">
              <svg style="width:12px;height:12px;color:#6ee7b7;flex-shrink:0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>
              <span>Thomas_Lefevre_CV.pdf</span>
            </div>
          </div>
          <div class="imp-file-ghost">
            <svg style="width:12px;height:12px;flex-shrink:0" fill="currentColor" viewBox="0 0 20 20"><path d="M4 18h12a2 2 0 002-2V6.414A2 2 0 0017.414 5L14 1.586A2 2 0 0012.586 1H4a2 2 0 00-2 2v13a2 2 0 002 2z"/></svg>
            <span>CV.pdf</span>
          </div>
        </div></div>

      </div>

      <div class="f-card card-sm" data-id="5">
        <div class="c-title">Optimis&eacute; pour les ATS</div>
        <div class="c-sub">Chaque mot compte</div>
        <div class="c-vis"><div class="vis-ats">
          <div class="ats-line old">Gestion de projets web complexes</div>
          <div class="ats-line old">Travail en &eacute;quipe agile</div>
          <div class="ats-line old">Cr&eacute;ation d'interfaces modernes</div>
        </div></div>

      </div>

    </div>

    <!-- ROW 2: scroll right (offset) -->
    <div class="marquee-row scroll-right" id="row2">

      <div class="f-card card-md" data-id="7">
        <div class="c-title">L'offre d&eacute;crypt&eacute;e pour vous</div>
        <div class="c-sub">Skills, process, b&eacute;n&eacute;fices extraits automatiquement</div>
        <div class="c-vis"><div class="vis-fiche">
          <div class="fiche-tags">
            <span class="fiche-tag skill">React</span>
            <span class="fiche-tag skill">TypeScript</span>
            <span class="fiche-tag method">Scrum</span>
            <span class="fiche-tag benefit">T&eacute;l&eacute;travail</span>
            <span class="fiche-tag skill">Node.js</span>
            <span class="fiche-tag benefit">50-60k&euro;</span>
            <span class="fiche-tag method">CI/CD</span>
          </div>
        </div></div>

      </div>

      <div class="f-card card-lg" data-id="8">
        <div class="c-title">L'IA vous guide pas &agrave; pas</div>
        <div class="c-sub">Suggestions cibl&eacute;es pour chaque offre</div>
        <div class="c-vis"><div class="vis-reco">
          <div class="reco-item">
            <div class="reco-header">
              <span class="reco-badge high">Haute</span>
              <span class="reco-pts">+5 pts</span>
            </div>
            <div class="reco-text">Ajouter outils de test (Jest, Cypress)</div>
          </div>
          <div class="reco-item">
            <div class="reco-header">
              <span class="reco-badge med">Moyenne</span>
              <span class="reco-pts">+4 pts</span>
            </div>
            <div class="reco-text">D&eacute;tailler l'exp&eacute;rience Design System</div>
          </div>
          <div class="reco-item">
            <div class="reco-header">
              <span class="reco-badge low">Faible</span>
              <span class="reco-pts">+2 pts</span>
            </div>
            <div class="reco-text">Mentionner accessibilit&eacute; WCAG</div>
          </div>
        </div></div>

      </div>

      <div class="f-card card-md" data-id="9">
        <div class="c-title">Gardez le contr&ocirc;le</div>
        <div class="c-sub">Acceptez ou refusez chaque modification</div>
        <div class="c-vis"><div class="vis-review">
          <div class="rev-change">
            <div class="rev-diff">
              <span class="rev-old">3 ans d'exp&eacute;rience</span>
              <span class="rev-new">3+ ans en d&eacute;veloppement web</span>
            </div>
            <div class="rev-actions">
              <span class="rev-btn rev-accept">&#10003;</span>
              <span class="rev-btn rev-reject">&#10005;</span>
            </div>
          </div>
          <div class="rev-change">
            <div class="rev-diff">
              <span class="rev-old">Bonne ma&icirc;trise de React</span>
              <span class="rev-new">Expert React &amp; TypeScript</span>
            </div>
            <div class="rev-actions">
              <span class="rev-btn rev-accept">&#10003;</span>
              <span class="rev-btn rev-reject">&#10005;</span>
            </div>
          </div>
        </div></div>

      </div>

      <div class="f-card card-sm" data-id="6">
        <div class="c-title">Votre score de matching</div>
        <div class="c-sub">Mesurez l'impact de chaque optimisation</div>
        <div class="c-vis"><div class="vis-score">
          <div class="sc-badge sc-old">
            <span class="sc-num">76</span>
          </div>
          <div class="sc-arrow">&#8594;</div>
          <div class="sc-badge sc-new">
            <svg class="sc-refresh" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
            <span class="sc-num"></span>
          </div>
        </div></div>

      </div>

      <div class="f-card card-sm" data-id="10">
        <div class="c-title">Voyagez dans le temps</div>
        <div class="c-sub">Restaurez facilement votre CV en un clic</div>
        <div class="c-vis"><div class="vis-history">
          <div class="hist-row"><span class="hist-label">v1</span><span class="hist-score hs-low">72</span></div>
          <div class="hist-row"><span class="hist-label">v2</span><span class="hist-score hs-mid">79</span></div>
          <div class="hist-row"><span class="hist-label">v3</span><span class="hist-score hs-high">94</span></div>
        </div></div>

      </div>

    </div>

    <!-- ROW 3: scroll left slow -->
    <div class="marquee-row scroll-left-slow" id="row3">

      <div class="f-card card-md" data-id="11">
        <div class="c-title">&Eacute;ditez directement dans l'app</div>
        <div class="c-sub">Chaque section modifiable en un clic</div>
        <div class="c-vis"><div class="vis-inline">
          <div class="inl-row">
            <div class="inl-text">Exp&eacute;rience professionnelle</div>
            <div class="inl-kebab">&#8942;</div>
            <div class="inl-menu">
              <div class="inl-opt edit">&#9998; Modifier</div>
              <div class="inl-opt del">&#10005; Supprimer</div>
            </div>
          </div>
          <div class="inl-row">
            <div class="inl-text">Comp&eacute;tences techniques</div>
            <div class="inl-kebab">&#8942;</div>
          </div>
          <div class="inl-row">
            <div class="inl-text">Formation</div>
            <div class="inl-kebab">&#8942;</div>
          </div>
        </div></div>

      </div>

      <div class="f-card card-md" data-id="12">
        <div class="c-title">Exportez en un clic</div>
        <div class="c-sub">PDF, Word, le format qui vous convient</div>
        <div class="c-vis"><div class="vis-export-order">
          <div class="exo-card" data-idx="0"><span class="exo-handle">&#10303;</span><span class="exo-check">&#10003;</span><span class="exo-name">Summary</span></div>
          <div class="exo-card" data-idx="1"><span class="exo-handle">&#10303;</span><span class="exo-check">&#10003;</span><span class="exo-name">Skills</span></div>
          <div class="exo-card" data-idx="2"><span class="exo-handle">&#10303;</span><span class="exo-check">&#10003;</span><span class="exo-name">Experience</span></div>
          <div class="exo-btn">Exporter PDF</div>
        </div></div>

      </div>

      <div class="f-card card-sm" data-id="13">
        <div class="c-title">Une interface, 4 langues</div>
        <div class="c-sub">Fran&ccedil;ais, Anglais, Allemand, Espagnol</div>
        <div class="c-vis"><div class="vis-lang-btn">
          <div class="lang-badge">
            <img class="lang-flag" data-lang="0" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22cFR%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url(%23cFR)%22%3E%3Crect%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23002395%22%2F%3E%3Crect%20x%3D%22170%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23fff%22%2F%3E%3Crect%20x%3D%22340%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23ED2939%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="FR">
            <img class="lang-flag" data-lang="1" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22cGB%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url(%23cGB)%22%3E%3Crect%20width%3D%22512%22%20height%3D%22512%22%20fill%3D%22%23012169%22%2F%3E%3Cpath%20d%3D%22M0%2C0L512%2C512M512%2C0L0%2C512%22%20stroke%3D%22%23fff%22%20stroke-width%3D%2260%22%2F%3E%3Cpath%20d%3D%22M0%2C0L512%2C512M512%2C0L0%2C512%22%20stroke%3D%22%23C8102E%22%20stroke-width%3D%2240%22%2F%3E%3Cpath%20d%3D%22M256%2C0v512M0%2C256h512%22%20stroke%3D%22%23fff%22%20stroke-width%3D%22100%22%2F%3E%3Cpath%20d%3D%22M256%2C0v512M0%2C256h512%22%20stroke%3D%22%23C8102E%22%20stroke-width%3D%2260%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="GB">
            <img class="lang-flag" data-lang="2" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22circleClip%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url%28%23circleClip%29%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23000000%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22170%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23DD0000%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22340%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23FFCC00%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="DE">
            <img class="lang-flag" data-lang="3" src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22circleClip%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url%28%23circleClip%29%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%22512%22%20height%3D%22130%22%20fill%3D%22%23AA151B%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22128%22%20width%3D%22512%22%20height%3D%22256%22%20fill%3D%22%23F1BF00%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22382%22%20width%3D%22512%22%20height%3D%22130%22%20fill%3D%22%23AA151B%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="ES">
          </div>
          <div class="lang-label">Français</div>
        </div></div>

      </div>

      <div class="f-card card-lg" data-id="15">
        <div class="c-title">Vos t&acirc;ches tournent en arri&egrave;re-plan</div>
        <div class="c-sub">G&eacute;n&eacute;rez, partez, c'est pr&ecirc;t &agrave; votre retour</div>
        <div class="c-vis"><div class="vis-tasks">
          <div class="tsk-item">
            <div class="tsk-line1">
              <span class="tsk-title">Senior Frontend Engineer</span>
              <span class="tsk-pct" data-end="100">0%</span>
            </div>
            <div class="tsk-bar"><div class="tsk-fill" data-end="100"></div></div>
            <div class="tsk-step">En attente...</div>
          </div>
          <div class="tsk-item">
            <div class="tsk-line1">
              <span class="tsk-title">Product Manager</span>
              <span class="tsk-pct" data-end="100">0%</span>
            </div>
            <div class="tsk-bar"><div class="tsk-fill" data-end="100"></div></div>
            <div class="tsk-step">En attente...</div>
          </div>
        </div></div>

      </div>

      <div class="f-card card-lg" data-id="14">
        <div class="c-title">Traduisez votre CV</div>
        <div class="c-sub">Dans 4 langues, vocabulaire professionnel adapt&eacute;</div>
        <div class="c-vis"><div class="vis-translate">
          <div class="tr-carousel">
            <div class="tr-flag" data-pos="-1"><img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22circleClip%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url%28%23circleClip%29%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%22512%22%20height%3D%22130%22%20fill%3D%22%23AA151B%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22128%22%20width%3D%22512%22%20height%3D%22256%22%20fill%3D%22%23F1BF00%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22382%22%20width%3D%22512%22%20height%3D%22130%22%20fill%3D%22%23AA151B%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="ES"></div>
            <div class="tr-flag" data-pos="0"><img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22cFR%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url(%23cFR)%22%3E%3Crect%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23002395%22%2F%3E%3Crect%20x%3D%22170%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23fff%22%2F%3E%3Crect%20x%3D%22340%22%20width%3D%22172%22%20height%3D%22512%22%20fill%3D%22%23ED2939%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="FR"></div>
            <div class="tr-flag" data-pos="1"><img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22cGB%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url(%23cGB)%22%3E%3Crect%20width%3D%22512%22%20height%3D%22512%22%20fill%3D%22%23012169%22%2F%3E%3Cpath%20d%3D%22M0%2C0L512%2C512M512%2C0L0%2C512%22%20stroke%3D%22%23fff%22%20stroke-width%3D%2260%22%2F%3E%3Cpath%20d%3D%22M0%2C0L512%2C512M512%2C0L0%2C512%22%20stroke%3D%22%23C8102E%22%20stroke-width%3D%2240%22%2F%3E%3Cpath%20d%3D%22M256%2C0v512M0%2C256h512%22%20stroke%3D%22%23fff%22%20stroke-width%3D%22100%22%2F%3E%3Cpath%20d%3D%22M256%2C0v512M0%2C256h512%22%20stroke%3D%22%23C8102E%22%20stroke-width%3D%2260%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="GB"></div>
            <div class="tr-flag" data-pos="2"><img src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22circleClip%22%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22256%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20clip-path%3D%22url%28%23circleClip%29%22%3E%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23000000%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22170%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23DD0000%22%2F%3E%3Crect%20x%3D%220%22%20y%3D%22340%22%20width%3D%22512%22%20height%3D%22172%22%20fill%3D%22%23FFCC00%22%2F%3E%3C%2Fg%3E%3Ccircle%20cx%3D%22256%22%20cy%3D%22256%22%20r%3D%22253%22%20fill%3D%22none%22%20stroke%3D%22%2300000022%22%20stroke-width%3D%226%22%2F%3E%3C%2Fsvg%3E" alt="DE"></div>
          </div>
        </div></div>

      </div>

    </div>

  </div>
</section>

<script>
// ===== SETUP =====
const rows = document.querySelectorAll('.marquee-row');
const rowArr = [...rows];
const DUR = { 'scroll-left': 50, 'scroll-right': 55, 'scroll-left-slow': 60 };
let preventNextClick = false;
let activeRow = null; // the row currently being dragged (mouse)

// Duplicate children enough times to fill viewport
rows.forEach(row => {
  const originals = [...row.children];
  // Calculate how many copies we need: at least 2 sets, more if viewport is wide
  const setWidth = originals.reduce((s, c) => s + c.offsetWidth, 0) +
    (originals.length - 1) * (parseFloat(getComputedStyle(row).gap) || 16);
  const copies = Math.max(1, Math.ceil(window.innerWidth / setWidth));
  for (let i = 0; i < copies; i++) {
    originals.forEach(c => row.appendChild(c.cloneNode(true)));
  }
  row._copies = copies;
  row._ac = [...row.classList].find(c => c.startsWith('scroll-'));
});

// Mouse gradient on cards — single delegated listener
const grid = document.querySelector('.marquee-grid');
grid.addEventListener('mousemove', e => {
  const c = e.target.closest('.f-card');
  if (!c) return;
  const r = c.getBoundingClientRect();
  c.style.setProperty('--mx', ((e.clientX - r.left) / r.width * 100) + '%');
  c.style.setProperty('--my', ((e.clientY - r.top) / r.height * 100) + '%');
});

function getStride(row) {
  const totalSets = (row._copies || 1) + 1;
  const gap = parseFloat(getComputedStyle(row).gap) || 16;
  return row.scrollWidth / totalSets + gap / totalSets;
}

function wrap(row) {
  if (row._cx <= -row._hw) row._cx += row._hw;
  if (row._cx >= 0) row._cx -= row._hw;
}

function applyX(row) {
  row.style.transform = 'translateX(' + row._cx + 'px)';
}

// ===== INIT ROWS =====
rows.forEach(row => {
  const ac = row._ac;
  const dur = DUR[ac] || 40;
  const dir = ac === 'scroll-right' ? 1 : -1;

  row._dur = dur;
  row._dir = dir;
  row._hw = getStride(row);
  row._cx = ac === 'scroll-right' ? -row._hw : 0;
  row._paused = false;
  row._hovered = false;
  row._vel = 0;
  row._hasMomentum = false;
  row._autoSpeed = row._hw / (dur * 60) * dir;

  // Remove CSS animation, full JS control
  row.classList.remove(ac);
  row.style.cursor = 'grab';
  applyX(row);
});

// ===== SINGLE rAF LOOP =====
let rafId = 0;
let pageVisible = true;

function tick() {
  if (pageVisible) {
    for (let i = 0; i < rowArr.length; i++) {
      const row = rowArr[i];
      if (row._hasMomentum) {
        row._vel *= 0.96;
        if (Math.abs(row._vel) < 0.3) {
          row._hasMomentum = false;
          row._paused = false;
        } else {
          row._cx += row._vel;
          wrap(row); applyX(row);
        }
      } else if (!row._paused && !row._hovered) {
        row._cx += row._autoSpeed;
        wrap(row); applyX(row);
      }
    }
  }
  rafId = requestAnimationFrame(tick);
}
rafId = requestAnimationFrame(tick);

// Pause when tab hidden
document.addEventListener('visibilitychange', () => {
  pageVisible = !document.hidden;
});

// Recalculate on resize (card sizes change between desktop/mobile)
let resizeTimer;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(() => {
    for (let i = 0; i < rowArr.length; i++) {
      const row = rowArr[i];
      const oldHw = row._hw;
      const newHw = getStride(row);
      if (oldHw > 0 && newHw > 0) {
        row._cx = (row._cx / oldHw) * newHw;
      }
      row._hw = newHw;
      row._autoSpeed = newHw / (row._dur * 60) * row._dir;
    }
  }, 150);
});

// ===== TOUCH EVENTS (per-row) =====
rows.forEach(row => {
  let startX = 0, startY = 0, lastX = 0, lastT = 0;
  let dragging = false, dist = 0;
  let dirLocked = false, isHoriz = false;

  row.addEventListener('touchstart', e => {
    const t = e.touches[0];
    startX = t.clientX; startY = t.clientY;
    lastX = startX; lastT = Date.now(); row._t0 = lastT;
    dragging = false; dist = 0;
    dirLocked = false; isHoriz = false;
    row._vel = 0; row._hasMomentum = false;
    row._paused = true;
  }, { passive: true });

  row.addEventListener('touchmove', e => {
    const t = e.touches[0];
    const now = Date.now(); const dt = now - lastT;

    if (!dirLocked) {
      const totalDx = Math.abs(t.clientX - startX);
      const totalDy = Math.abs(t.clientY - startY);
      if (totalDx > 12 || totalDy > 12) {
        dirLocked = true;
        isHoriz = totalDx > totalDy * 1.5;
        if (!isHoriz) { row._paused = false; return; }
      } else { return; }
    }
    if (!isHoriz) { row._paused = false; return; }

    e.preventDefault();
    dragging = true;
    const dx = t.clientX - lastX;
    dist += Math.abs(dx);
    row._cx += dx; wrap(row); applyX(row);
    if (dt > 0) row._vel = dx / dt * 16;
    lastX = t.clientX; lastT = now;
  }, { passive: false });

  row.addEventListener('touchend', () => {
    const elapsed = Date.now() - (row._t0 || 0);
    if (elapsed < 300 && dist < 15) { row._paused = false; return; }
    preventNextClick = true;
    if (dragging && Math.abs(row._vel) > 0.5) { row._hasMomentum = true; }
    else { row._paused = false; }
  });
});

// ===== HOVER PAUSE (desktop only) =====
const hasHover = window.matchMedia('(hover: hover)').matches;
if (hasHover) {
  rows.forEach(row => {
    row._hoverTimer = null;
    row.addEventListener('mouseenter', () => {
      clearTimeout(row._hoverTimer);
      row._hovered = true;
    });
    row.addEventListener('mouseleave', () => {
      row._hoverTimer = setTimeout(() => { row._hovered = false; }, 150);
    });
  });

  // Card hover class (replaces CSS :hover to prevent flicker during wrap)
  let _hovId = null, _hovTimer = null;
  function _setHov(id) {
    if (id === _hovId) return;
    clearTimeout(_hovTimer);
    if (_hovId) document.querySelectorAll('.f-card[data-id="' + _hovId + '"]').forEach(c => c.classList.remove('hovered'));
    _hovId = id;
    if (id) document.querySelectorAll('.f-card[data-id="' + id + '"]').forEach(c => c.classList.add('hovered'));
  }
  document.querySelectorAll('.f-card').forEach(card => {
    card.addEventListener('mouseenter', () => {
      clearTimeout(_hovTimer);
      _setHov(card.dataset.id);
    });
    card.addEventListener('mouseleave', () => {
      _hovTimer = setTimeout(() => _setHov(null), 150);
    });
  });
}

// ===== MOUSE EVENTS — single document-level listeners =====
let mStartX = 0, mLastX = 0, mLastT = 0;
let mDragging = false, mDist = 0;

// mousedown on each row (lightweight — just captures)
rows.forEach(row => {
  row.addEventListener('mousedown', e => {
    if (e.button !== 0) return;
    e.preventDefault();
    activeRow = row;
    mStartX = e.clientX; mLastX = e.clientX; mLastT = Date.now(); row._t0 = mLastT;
    mDragging = false; mDist = 0;
    row._vel = 0; row._hasMomentum = false;
    row._paused = true;
    row.style.cursor = 'grabbing';
  });
});

// Single mousemove on document
document.addEventListener('mousemove', e => {
  if (!activeRow) return;
  const row = activeRow;
  const dx = e.clientX - mLastX;
  const now = Date.now(); const dt = now - mLastT;

  if (Math.abs(e.clientX - mStartX) > 5) mDragging = true;

  mDist += Math.abs(dx);
  row._cx += dx; wrap(row); applyX(row);
  if (dt > 0) row._vel = dx / dt * 16;
  mLastX = e.clientX; mLastT = now;
});

// Single mouseup on document
document.addEventListener('mouseup', () => {
  if (!activeRow) return;
  const row = activeRow;
  activeRow = null;
  row.style.cursor = 'grab';

  const elapsed = Date.now() - (row._t0 || 0);
  if (elapsed < 250 && mDist < 8) { row._paused = false; return; }
  if (mDist > 8) preventNextClick = true;

  if (mDragging && Math.abs(row._vel) > 0.5) { row._hasMomentum = true; }
  else { row._paused = false; }
});

// ===== SCORE ANIMATION =====
const sObs = new IntersectionObserver(es => {
  es.forEach(e => { if(e.isIntersecting){ const c=e.target.querySelector('.mini-circle'); if(c)setTimeout(()=>c.classList.add('anim'),400); sObs.unobserve(e.target); }});
},{threshold:0.3});
document.querySelectorAll('.vis-score').forEach(el => sObs.observe(el.closest('.f-card')));

// ===== CARD 1: Generator modal animation =====
(function() {
  const url = 'https://wttj.com/fr/companies/techvision/jobs/senior-frontend';
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  // Animate ALL instances (original + clones)
  document.querySelectorAll('.vis-gen').forEach(vis => {
    const cursor = vis.querySelector('.gm-cursor');
    const linkEl = vis.querySelector('.gm-input');
    const valBtn = vis.querySelector('.gm-validate');
    if (!cursor || !linkEl || !valBtn) return;

    function moveTo(el) {
      const vr = vis.getBoundingClientRect();
      const er = el.getBoundingClientRect();
      const t = getComputedStyle(vis).transform;
      const scale = t && t !== 'none' ? new DOMMatrix(t).a : 1;
      cursor.style.left = ((er.left - vr.left + er.width * 0.5) / scale) + 'px';
      cursor.style.top = ((er.top - vr.top + er.height * 0.5) / scale) + 'px';
    }

    async function cycle() {
      try {
        linkEl.textContent = '';
        cursor.style.opacity = '0';
        valBtn.classList.remove('flash');
        await wait(800);

        cursor.style.opacity = '1';
        moveTo(linkEl);
        await wait(600);

        linkEl.classList.add('typing');
        for (let i = 0; i <= url.length; i++) {
          linkEl.textContent = url.slice(0, i);
          await wait(25);
        }
        linkEl.classList.remove('typing');
        await wait(400);

        moveTo(valBtn);
        await wait(500);

        valBtn.classList.add('flash');
        cursor.style.transform = 'scale(0.85)';
        await wait(150);
        cursor.style.transform = '';
        await wait(300);

        await wait(1200);

        cursor.style.opacity = '0';
        await wait(500);
        valBtn.classList.remove('flash');
      } catch(e) {}

      setTimeout(cycle, 300);
    }

    cycle();
  });
})();

// ===== CARD 2: Batch generation animation =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-batch').forEach(vis => {
    const docs = vis.querySelectorAll('.batch-doc');
    const numEl = vis.querySelector('.bc-num');

    async function cycle() {
      try {
        docs.forEach(d => d.classList.remove('visible', 'done'));
        if (numEl) numEl.textContent = '0';
        await wait(600);

        for (let i = 0; i < docs.length; i++) {
          docs[i].classList.add('visible');
          await wait(250);
          docs[i].classList.add('done');
          if (numEl) numEl.textContent = String((i + 1) * 2);
          await wait(200);
        }

        await wait(1500);

        docs.forEach(d => d.classList.remove('visible', 'done'));
        await wait(500);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 3: Template search bar typing =====
(function() {
  const title = 'Product Manager Senior';
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.tpl-search-text').forEach(el => {
    async function cycle() {
      try {
        el.textContent = '';
        await wait(800);
        for (let i = 0; i <= title.length; i++) {
          el.textContent = title.slice(0, i);
          await wait(45);
        }
        await wait(2000);
        el.textContent = '';
        await wait(400);
      } catch(e) {}
      setTimeout(cycle, 300);
    }
    cycle();
  });
})();

// ===== CARD 4: Import drag-and-drop =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-import').forEach(vis => {
    const zone = vis.querySelector('.imp-zone');
    const ghost = vis.querySelector('.imp-file-ghost');

    async function cycle() {
      try {
        // Reset
        zone.classList.remove('drag-over', 'loaded');
        ghost.classList.remove('visible');
        ghost.style.transform = '';
        await wait(800);

        // File ghost appears top-right
        ghost.classList.add('visible');
        await wait(400);

        // Ghost moves toward the zone
        ghost.style.transition = 'transform 0.8s ease-in-out';
        ghost.style.transform = 'translate(-2rem, 1.5rem)';
        await wait(500);

        // Drag-over state
        zone.classList.add('drag-over');
        await wait(600);

        // Drop: ghost disappears, zone turns green with filename
        ghost.classList.remove('visible');
        ghost.style.transition = 'none';
        ghost.style.transform = '';
        zone.classList.remove('drag-over');
        zone.classList.add('loaded');
        await wait(2500);

        // Reset
        zone.classList.remove('loaded');
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 5: ATS rewrite =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }
  const rewrites = [
    'Pilotage de projets web full-stack',
    'Méthodologie Scrum & sprints agiles',
    'Conception UI/UX responsive (React)'
  ];

  document.querySelectorAll('.vis-ats').forEach(vis => {
    const lines = vis.querySelectorAll('.ats-line');

    async function cycle() {
      try {
        // Reset all to old
        lines.forEach((l, i) => {
          l.classList.add('old');
          l.classList.remove('rewriting');
          l.textContent = ['Gestion de projets web complexes','Travail en équipe agile','Création d\'interfaces modernes'][i];
        });
        await wait(800);

        // Rewrite line by line
        for (let i = 0; i < lines.length; i++) {
          lines[i].classList.remove('old');
          lines[i].classList.add('rewriting');
          lines[i].textContent = '';
          for (let c = 0; c <= rewrites[i].length; c++) {
            lines[i].textContent = rewrites[i].slice(0, c);
            await wait(30);
          }
          await wait(400);
        }

        await wait(2000);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 6: Score badge =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-score').forEach(vis => {
    const oldBadge = vis.querySelector('.sc-old');
    const arrow = vis.querySelector('.sc-arrow');
    const newBadge = vis.querySelector('.sc-new');
    const refresh = vis.querySelector('.sc-refresh');
    const newNum = newBadge.querySelector('.sc-num');

    async function cycle() {
      try {
        // Reset
        oldBadge.classList.remove('visible');
        arrow.classList.remove('visible');
        newBadge.classList.remove('visible');
        refresh.classList.remove('hidden', 'spinning');
        newNum.textContent = '';
        newBadge.style.borderColor = 'rgba(255,255,255,0.3)';
        await wait(600);

        // Old score appears (74 orange)
        oldBadge.classList.add('visible');
        await wait(600);

        // Arrow appears
        arrow.classList.add('visible');
        await wait(400);

        // New badge appears with refresh spinning
        newBadge.classList.add('visible');
        refresh.classList.add('spinning');
        await wait(1800);

        // Stop spin, show new score (87 green)
        refresh.classList.remove('spinning');
        refresh.classList.add('hidden');
        newBadge.style.borderColor = 'var(--green)';
        newNum.style.color = 'var(--green)';
        for (let n = 0; n <= 94; n += 3) {
          newNum.textContent = Math.min(n, 94);
          await wait(20);
        }
        newNum.textContent = '94';
        await wait(2500);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 7: Reco suggestions =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-reco').forEach(vis => {
    const items = vis.querySelectorAll('.reco-item');

    async function cycle() {
      try {
        items.forEach(i => i.classList.remove('visible'));
        await wait(600);

        for (let i = 0; i < items.length; i++) {
          items[i].classList.add('visible');
          await wait(500);
        }

        await wait(2500);

        items.forEach(i => i.classList.remove('visible'));
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 8: Fiche offre tags =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-fiche').forEach(vis => {
    const tags = vis.querySelectorAll('.fiche-tag');

    async function cycle() {
      try {
        tags.forEach(t => t.classList.remove('visible'));
        await wait(500);

        for (let i = 0; i < tags.length; i++) {
          tags[i].classList.add('visible');
          await wait(250);
        }

        await wait(2500);

        tags.forEach(t => t.classList.remove('visible'));
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 9: Review mode =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-review').forEach(vis => {
    const changes = vis.querySelectorAll('.rev-change');

    async function cycle() {
      try {
        // Reset
        changes.forEach(c => {
          c.classList.remove('visible', 'accepted', 'rejected');
          c.querySelectorAll('.rev-btn').forEach(b => b.classList.remove('flash'));
        });
        await wait(600);

        // Show both changes
        for (let i = 0; i < changes.length; i++) {
          changes[i].classList.add('visible');
          await wait(400);
        }
        await wait(600);

        // Accept first change
        const accept1 = changes[0].querySelector('.rev-accept');
        accept1.classList.add('flash');
        await wait(300);
        changes[0].classList.add('accepted');
        await wait(800);

        // Reject second change
        const reject2 = changes[1].querySelector('.rev-reject');
        reject2.classList.add('flash');
        await wait(300);
        changes[1].classList.add('rejected');
        await wait(2000);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 10: History versions =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-history').forEach(vis => {
    const rows = vis.querySelectorAll('.hist-row');

    async function cycle() {
      try {
        rows.forEach(r => r.classList.remove('visible', 'active'));
        await wait(600);

        for (let i = 0; i < rows.length; i++) {
          rows[i].classList.add('visible');
          await wait(400);
        }
        await wait(300);

        // Last one becomes active
        rows[rows.length - 1].classList.add('active');
        await wait(2500);

        rows.forEach(r => r.classList.remove('visible', 'active'));
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 11: Inline edit kebab =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-inline').forEach(vis => {
    const rows = vis.querySelectorAll('.inl-row');
    const menu = vis.querySelector('.inl-menu');
    const editOpt = menu.querySelector('.inl-opt.edit');

    async function cycle() {
      try {
        // Reset
        rows.forEach(r => r.classList.remove('active'));
        menu.classList.remove('visible');
        editOpt.classList.remove('highlight');
        await wait(800);

        // Activate first row kebab
        rows[0].classList.add('active');
        await wait(400);

        // Open menu
        menu.classList.add('visible');
        await wait(600);

        // Highlight "Modifier"
        editOpt.classList.add('highlight');
        await wait(2000);

        // Close
        editOpt.classList.remove('highlight');
        menu.classList.remove('visible');
        rows[0].classList.remove('active');
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 12: Export section reorder =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  document.querySelectorAll('.vis-export-order').forEach(vis => {
    const cards = vis.querySelectorAll('.exo-card');
    // card height + gap for translation
    function getStep() {
      if (cards.length < 2) return 0;
      return cards[1].offsetTop - cards[0].offsetTop;
    }

    async function cycle() {
      try {
        // Reset positions
        cards.forEach(c => { c.style.transform = ''; c.classList.remove('dragging'); });
        await wait(800);

        const step = getStep();
        // Drag card 2 (Experience) up above Skills
        cards[2].classList.add('dragging');
        await wait(300);
        cards[2].style.transform = `translateY(${-step}px)`;
        cards[1].style.transform = `translateY(${step}px)`;
        await wait(600);

        // Settle
        cards[2].classList.remove('dragging');
        await wait(200);

        // Swap DOM order visually by keeping transforms, then reset after pause
        await wait(2000);

        // Reset
        cards.forEach(c => { c.style.transform = ''; });
        await wait(400);
      } catch(e) {}

      setTimeout(cycle, 400);
    }

    cycle();
  });
})();

// ===== CARD 13: Language badge cycling =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }

  const langLabels = ['Français', 'English', 'Deutsch', 'Español'];

  document.querySelectorAll('.vis-lang-btn').forEach(vis => {
    const flags = vis.querySelectorAll('.lang-flag');
    const label = vis.querySelector('.lang-label');
    let idx = 0;

    async function cycle() {
      try {
        flags.forEach(f => f.classList.remove('active'));
        flags[idx].classList.add('active');
        if (label) label.textContent = langLabels[idx];
        await wait(2000);
        flags[idx].classList.remove('active');
        await wait(200);
        idx = (idx + 1) % flags.length;
      } catch(e) {}
      setTimeout(cycle, 100);
    }

    cycle();
  });
})();

// ===== TASK MANAGER CARD =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }
  const steps = ['Expériences', 'Compétences', 'Projets', 'Résumé', 'Terminé'];

  document.querySelectorAll('.vis-tasks').forEach(vis => {
    const items = [...vis.querySelectorAll('.tsk-item')];

    async function animateItem(item, delay) {
      await wait(delay);
      const fill = item.querySelector('.tsk-fill');
      const pct = item.querySelector('.tsk-pct');
      const step = item.querySelector('.tsk-step');
      let progress = 0;

      for (let s = 0; s < steps.length; s++) {
        const target = s === steps.length - 1 ? 100 : 20 + (s + 1) * 18;
        step.textContent = steps[s];
        fill.style.width = target + '%';
        pct.textContent = target + '%';
        if (target >= 100) {
          pct.textContent = 'Terminé';
          pct.classList.add('done');
          fill.classList.add('done');
        }
        await wait(500 + Math.random() * 400);
      }
    }

    async function cycle() {
      try {
        // Reset
        items.forEach(item => {
          item.querySelector('.tsk-fill').style.width = '0%';
          item.querySelector('.tsk-fill').classList.remove('done');
          item.querySelector('.tsk-pct').textContent = '0%';
          item.querySelector('.tsk-pct').classList.remove('done');
          item.querySelector('.tsk-step').textContent = 'En attente...';
        });
        await wait(800);

        // Animate staggered
        await Promise.all(items.map((item, i) => animateItem(item, i * 600)));
        await wait(2000);
      } catch(e) {}

      setTimeout(cycle, 300);
    }

    cycle();
  });
})();

// ===== TRANSLATE CARD — flags expand from center =====
(function() {
  function wait(ms) { return new Promise(r => setTimeout(r, ms)); }
  const order = [0,1,2,3]; // FR, GB, DE, ES

  document.querySelectorAll('.vis-translate').forEach(vis => {
    const flags = [...vis.querySelectorAll('.tr-flag')];
    // positions: -2(off-left) -1(left) 0(center) 1(right) 2(off-right)

    function rotate() {
      // Enable transitions
      flags.forEach(f => f.classList.add('tr-move'));

      flags.forEach(f => {
        let pos = parseInt(f.dataset.pos);
        pos--;
        // The one going to -2: after transition, warp to +2 instantly
        f.dataset.pos = pos;
      });

      // After transition ends, warp the -2 flag to +2 without animation
      setTimeout(() => {
        const offLeft = flags.find(f => f.dataset.pos === '-2');
        if (offLeft) {
          offLeft.classList.remove('tr-move');
          offLeft.dataset.pos = '2';
        }
      }, 550);
    }

    setInterval(rotate, 2000);
  });
})();

// ===== LANG CYCLING (paused when tab hidden) =====
let li = 0;
const lis = document.querySelectorAll('.lg-i');
const halfLis = lis.length / 2;
let langInterval = null;

function cycleLang() {
  lis.forEach(l => l.classList.remove('on'));
  li = (li + 1) % halfLis;
  for (let i = 0; i < lis.length; i++) {
    if (i % halfLis === li) lis[i].classList.add('on');
  }
}

function startLangCycle() {
  if (!langInterval && lis.length) langInterval = setInterval(cycleLang, 1500);
}
function stopLangCycle() {
  if (langInterval) { clearInterval(langInterval); langInterval = null; }
}

startLangCycle();
document.addEventListener('visibilitychange', () => {
  document.hidden ? stopLangCycle() : startLangCycle();
});

</script>

</body>
</html>
