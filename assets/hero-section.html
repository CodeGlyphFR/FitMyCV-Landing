<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FitMyCV - Hero Section</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0a1a;
    color: #fff;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    overflow-x: hidden;
  }

  /* ===== SCROLL SECTION ===== */
  .hero-section {
    position: relative;
    height: 170vh;
  }

  .hero-sticky {
    position: sticky;
    top: 0;
    height: 100vh; /* initial — shrinks via JS as scroll progresses */
    overflow: hidden;
  }

  /* --- Video background --- */
  .hero-video {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 1s ease;
    z-index: 0;
  }

  .hero-video.ready {
    opacity: 0.35;
  }

  .hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, rgba(10,10,26,0.6) 0%, transparent 12%, transparent 60%, rgba(10,10,26,0.7) 75%, #0a0a1a 90%);
    z-index: 1;
  }

  /* --- Title centered --- */
  .hero-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -60%);
    z-index: 3;
    text-align: center;
    width: 90%;
    animation: fadeInUp 1.5s ease-out;
  }

  .hero-title {
    font-size: clamp(2.5rem, 6vw, 5rem);
    font-weight: 800;
    letter-spacing: -0.03em;
    line-height: 1.1;
    margin-bottom: 0.8rem;
    background: linear-gradient(135deg, #22d3ee 0%, #34d399 40%, #60a5fa 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    filter: drop-shadow(0 0 25px rgba(52,211,153,0.35));
  }

  .hero-cta {
    position: relative;
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
    margin-top: 6rem;
    padding: 0.85rem 2.2rem;
    font-size: clamp(0.95rem, 1.5vw, 1.1rem);
    font-weight: 600;
    font-family: inherit;
    color: #fff;
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
    border: 1px solid rgba(16, 185, 129, 0.4);
    border-radius: 50px;
    cursor: pointer;
    text-decoration: none;
    transition: box-shadow 0.25s ease, border-color 0.25s ease;
    box-shadow: 0 0 25px rgba(16, 185, 129, 0.25), 0 4px 15px rgba(0,0,0,0.3);
    overflow: hidden;
    z-index: 1;
  }

  /* Shimmer sweep */
  .hero-cta::before {
    content: '';
    position: absolute;
    top: 0; left: -100%;
    width: 100%; height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
    transition: left 0.5s ease;
  }

  .hero-cta:hover::before {
    left: 100%;
  }

  .hero-cta:hover {
    box-shadow: 0 0 40px rgba(16, 185, 129, 0.4), 0 8px 25px rgba(0,0,0,0.3);
    border-color: rgba(16, 185, 129, 0.7);
  }

  .hero-cta .cta-arrow {
    display: inline-block;
    transition: transform 0.25s ease;
  }

  .hero-cta:hover .cta-arrow {
    transform: translateX(3px);
  }

  .hero-subtitle {
    font-size: clamp(0.95rem, 1.8vw, 1.3rem);
    color: rgba(255,255,255,0.7);
    font-weight: 600;
    max-width: 550px;
    margin: 0 auto;
    white-space: nowrap;
    min-height: 1.5em;
  }

  .hero-subtitle .cursor {
    display: inline-block;
    width: 2px;
    height: 1em;
    background: #10b981;
    vertical-align: text-bottom;
    margin-left: 2px;
    animation: blink 0.7s step-end infinite;
  }

  @keyframes blink { 50% { opacity: 0; } }
  @keyframes fadeInUp { from { opacity: 0; transform: translate(-50%, -50%) translateY(30px); } to { opacity: 1; transform: translate(-50%, -50%); } }

  /* --- Discover --- */
  .scroll-indicator {
    position: absolute;
    z-index: 5;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.4rem;
    animation: bounce 2s infinite;
  }

  .scroll-indicator span {
    font-size: 0.7rem;
    color: rgba(255,255,255,0.5);
    text-transform: uppercase;
    letter-spacing: 0.15em;
  }

  .scroll-chevron {
    width: 18px;
    height: 18px;
    border-right: 2px solid rgba(255,255,255,0.4);
    border-bottom: 2px solid rgba(255,255,255,0.4);
    transform: rotate(45deg);
  }

  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
    40% { transform: translateX(-50%) translateY(-8px); }
    60% { transform: translateX(-50%) translateY(-4px); }
  }

  /* --- Mockup wrapper (positioned absolutely, slides up) --- */
  .mockup-wrapper {
    position: absolute;
    left: 50%;
    z-index: 4;
    perspective: 1200px;
  }

  /*
    Mockup visible container — takes 66% of viewport width.
    The iframe inside renders at a fixed 960px base and is scaled up.
  */
  .mockup-frame {
    width: min(960px, 90vw);
    border-radius: 12px 12px 0 0;
    overflow: hidden;
    position: relative;
    /* Initial tilt — animated via JS */
    transform: rotateX(20deg);
    transform-origin: center top;
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /*
    Iframe renders at fixed 960x600 (mockup's design resolution)
    then scaled to fill the .mockup-frame container via JS.
    The container height is set by JS to match the scaled iframe height.
  */
  .mockup-frame iframe {
    position: absolute;
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    top: 0;
    left: 0;
    width: 960px;
    height: 600px;
    border: none;
    transform-origin: top left;
  }



  /* Glow under mockup */
  .mockup-glow {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 50%;
    height: 80px;
    background: radial-gradient(ellipse, rgba(16,185,129,0.2) 0%, transparent 70%);
    opacity: 0;
    pointer-events: none;
    z-index: 3;
  }

  /* ===== AFTER CONTENT ===== */
  .content-after {
    position: relative;
    z-index: 5;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem 2rem 4rem;
    text-align: center;
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }

  .content-after.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .content-after h2 {
    font-size: clamp(1.8rem, 4vw, 3rem);
    font-weight: 700;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, #10b981, #3b82f6);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .content-after p {
    color: rgba(255,255,255,0.6);
    max-width: 600px;
    line-height: 1.7;
  }

</style>
</head>
<body>

<section class="hero-section">
  <div class="hero-sticky" id="heroSticky">

    <!-- Video BG -->
    <video class="hero-video" autoplay muted playsinline preload="auto">
      <source src="background_video.mp4" type="video/mp4">
    </video>
    <div class="hero-overlay"></div>

    <!-- Title centered -->
    <div class="hero-content" id="heroContent">
      <h1 class="hero-title">Votre CV, optimisé par l'IA</h1>
      <p class="hero-subtitle"><span id="heroSubtitle"></span><span class="cursor"></span></p>
      <a href="https://app.fitmycv.io" class="hero-cta">Démarrer maintenant <span class="cta-arrow">&rarr;</span></a>
    </div>

    <!-- Discover — positioned dynamically above mockup -->
    <div class="scroll-indicator" id="scrollIndicator">
      <span>Discover</span>
      <div class="scroll-chevron"></div>
    </div>

    <!-- Mockup — starts peeking 1/3 from bottom, slides up on scroll -->
    <div class="mockup-wrapper" id="mockupWrapper">
      <div class="mockup-frame" id="mockupFrame">
        <iframe id="mockupIframe"
                src="/mockups/workflow-demo.html?embed"
                style="width:960px;height:600px;border:none;transform-origin:top left;">
        </iframe>
      </div>
    </div>
    <div class="mockup-glow" id="mockupGlow"></div>

  </div>
</section>



<script>
  const heroSticky = document.getElementById('heroSticky');
  const heroContent = document.getElementById('heroContent');
  const scrollIndicator = document.getElementById('scrollIndicator');
  const mockupWrapper = document.getElementById('mockupWrapper');
  const mockupFrame = document.getElementById('mockupFrame');
  const mockupIframe = document.getElementById('mockupIframe');
  const mockupGlow = document.getElementById('mockupGlow');
  const section = document.querySelector('.hero-section');
  const heroVideo = document.querySelector('.hero-video');

  let demoStarted = false;
  let demoPaused = false;

  // Iframe base resolution (mockup's design size)
  const BASE_W = 960;
  const BASE_H = 600;

  // Fade in video when ready
  heroVideo.loop = false;
  if (heroVideo.readyState >= 3) {
    heroVideo.classList.add('ready');
  } else {
    heroVideo.addEventListener('canplay', () => heroVideo.classList.add('ready'), { once: true });
  }

  heroVideo.addEventListener('ended', () => {
    heroVideo.style.transition = 'opacity 1s';
    heroVideo.style.opacity = '0.6';
  });

  // Animation params
  const MAX_TILT = 20;
  const VISIBLE_RATIO = 0.33;

  // Compute scale + set container height to match scaled iframe
  function updateScale() {
    const containerW = mockupFrame.offsetWidth;
    const scale = containerW / BASE_W;
    const scaledH = BASE_H * scale;
    mockupFrame.style.height = `${scaledH}px`;

    // Scale iframe to fill container
    mockupIframe.style.transform = `scale(${scale})`;

    return { scale, scaledH };
  }

  function update() {
    const { scaledH } = updateScale();
    const rect = section.getBoundingClientRect();
    const sectionHeight = rect.height - window.innerHeight;
    const scrolled = -rect.top;
    const progress = Math.max(0, Math.min(1, scrolled / sectionHeight));
    const vh = window.innerHeight;

    const mockupHeight = scaledH;

    // --- Mockup Y position ---
    const startY = vh - (mockupHeight * VISIBLE_RATIO);
    const endY = (vh - mockupHeight) / 2;
    const easedPos = 1 - Math.pow(1 - progress, 3);
    const currentY = startY + (endY - startY) * easedPos;

    mockupWrapper.style.top = `${currentY}px`;
    mockupWrapper.style.left = '50%';
    mockupWrapper.style.transform = `translateX(-50%)`;

    // --- Tilt ---
    const easedTilt = 1 - Math.pow(1 - progress, 3);
    const currentTilt = MAX_TILT * (1 - easedTilt);
    mockupFrame.style.transform = `rotateX(${currentTilt}deg)`;

    // --- Discover above mockup ---
    const discoverBottom = vh - currentY + 16;
    scrollIndicator.style.bottom = `${discoverBottom}px`;

    // --- Position title between top and mockup ---
    const titleY = currentY / 2;
    heroContent.style.top = `${titleY}px`;
    heroContent.style.transform = `translate(-50%, -50%)`;

    // --- Fade out hero + Discover ---
    const fadeOut = Math.max(0, 1 - progress * 2.5);
    heroContent.style.opacity = fadeOut;
    scrollIndicator.style.opacity = fadeOut;

    // --- Scroll up + fade out video ---
    heroVideo.style.transform = `translateY(${-progress * vh * 0.4}px)`;
    if (progress > 0.01) {
      heroVideo.style.opacity = Math.max(0, 0.35 - (progress * 0.5));
    } else {
      heroVideo.style.removeProperty('opacity');
    }

    // --- Overlay follows video + darkens ---
    const overlay = document.querySelector('.hero-overlay');
    overlay.style.transform = `translateY(${-progress * vh * 0.4}px)`;
    overlay.style.background = `linear-gradient(to bottom,
      rgba(10,10,26,${0.6 + progress * 0.4}) 0%,
      transparent 12%,
      transparent ${60 - progress * 20}%,
      rgba(10,10,26,${0.7 + progress * 0.3}) ${75 - progress * 10}%,
      #0a0a1a ${90 - progress * 10}%)`;

    // --- Glow ---
    const glowY = currentY + mockupHeight + 5;
    mockupGlow.style.top = `${glowY}px`;
    mockupGlow.style.opacity = Math.max(0, (progress - 0.6) / 0.4);

    // --- Shrink sticky to wrap mockup + glow ---
    const finalStickyH = endY + mockupHeight + 90;
    heroSticky.style.height = `${vh + (finalStickyH - vh) * easedPos}px`;

    // --- Start demo when mockup is in position ---
    if (progress > 0.1 && !demoStarted) {
      demoStarted = true;
      demoPaused = false;
      mockupIframe.contentWindow.postMessage('start-demo', '*');
    }

    // --- Pause/resume based on mockup visibility ---
    if (demoStarted) {
      const mockupVisible = currentY < vh && currentY + mockupHeight > 0 && progress > 0.3;
      if (!mockupVisible && !demoPaused) {
        demoPaused = true;
        mockupIframe.contentWindow.postMessage('pause-demo', '*');
      } else if (mockupVisible && demoPaused) {
        demoPaused = false;
        mockupIframe.contentWindow.postMessage('resume-demo', '*');
      }
    }

    requestAnimationFrame(update);
  }

  requestAnimationFrame(update);

  // --- Typewriter ---
  const subtitleEl = document.getElementById('heroSubtitle');
  const phrases = [
    'Fini le copier-coller — une URL suffit',
    '10 liens, 10 CV générés en même temps',
    'Analysez, scorez, optimisez — en quelques secondes',
    'Sans abonnement — paiement à la demande',
    '7 étapes pour un CV parfait',
  ];

  async function typewrite() {
    for (const phrase of phrases) {
      // Type character by character
      for (let i = 0; i <= phrase.length; i++) {
        subtitleEl.textContent = phrase.slice(0, i);
        await new Promise(r => setTimeout(r, 40));
      }
      // Pause
      await new Promise(r => setTimeout(r, 1000));
      // Erase word by word
      const words = phrase.split(' ');
      while (words.length > 0) {
        words.pop();
        subtitleEl.textContent = words.join(' ');
        await new Promise(r => setTimeout(r, 80));
      }
      // Brief pause before next phrase
      await new Promise(r => setTimeout(r, 400));
    }
    typewrite(); // Loop
  }

  setTimeout(typewrite, 1500);
</script>
</body>
</html>
